#ifdef UNICODE
  #define AW "W"
#else
  #define AW "A"
#endif

procedure InstallNETWindowsRuntime;
begin
    ExecuteProgram2(ExpandConstant('{tmp}\{#DOTNETRUNTIMEEXEFILENAME}'),'/install /quiet /norestart',0,1638,0);
end;


function SetEnvironmentVariable(lpName: string; lpValue: string): BOOL;
  external 'SetEnvironmentVariable{#AW}@kernel32.dll stdcall';

procedure InstallNETRuntime;
begin
    SetEnvironmentVariable('InnosetupTmpPath', ExpandConstant('{tmp}'));
    ExecuteProgram2('powershell.exe','-ExecutionPolicy Unrestricted -EncodedCommand "IwAjACMAIwAjACMAIwAKAHQAcgB5ACAAewAKACAAIABmAHUAbgBjAHQAaQBvAG4AIABlAHgAZQBjAHUAdABlAE4AZQB0AEkAbgBzAHQAYQBsAGwAZQByAHMAKAAkAG4AZQB0AEYAbwBsAGQAZQByACkAIAB7AAoAIAAgACAAIABpAGYAIAAoAFQAZQBzAHQALQBQAGEAdABoACAAJABuAGUAdABGAG8AbABkAGUAcgApACAAewAKACAAIAAgACAAIAAgACAAIABHAGUAdAAtAEkAdABlAG0AIAAiACQAbgBlAHQARgBvAGwAZABlAHIAXAAqACIAIAB8ACAARgBvAHIARQBhAGMAaAAtAE8AYgBqAGUAYwB0ACAAewAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAGkAZgAgACgAJABfAC4ATgBhAG0AZQAuAHQAcgBpAG0AKAApACAALQBuAGUAIAAiAHQAZQBzAHQAaQBuAGcALgB0AHgAdAAiACkAIAB7AAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAkAGUAeABlAFAAYQB0AGgAIAA9ACAAIgAkAG4AZQB0AEYAbwBsAGQAZQByAFwAJAAoACQAXwAuAE4AYQBtAGUAKQAiAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABXAHIAaQB0AGUALQBIAG8AcwB0ACAAJABlAHgAZQBQAGEAdABoAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAmACAAIgAkAGUAeABlAFAAYQB0AGgAIgAgACIALwBpAG4AcwB0AGEAbABsACIAIAAiAC8AcQB1AGkAZQB0ACIAIAAiAC8AbgBvAHIAZQBzAHQAYQByAHQAIgAgAHwAIABvAHUAdAAtAHMAdAByAGkAbgBnAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIABpAGYAKAAkAGwAYQBzAHQAZQB4AGkAdABjAG8AZABlACAALQBuAGUAIAAwACkAIAB7AAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAdABoAHIAbwB3ACAAIgBJAG4AcwB0AGEAbABsAGkAbgBnACAAJAAoACQAXwAuAE4AYQBtAGUAKQA6ACAAbABhAHMAdAAgAGUAeABpAHQAIABjAG8AZABlACAAdwBhAHMAIABuAG8AdAAgADAAIgAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAfQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ACgAgACAAIAAgACAAIAAgACAAfQAKACAAIAAgACAAfQAKACAAIAB9AAoAIAAgAGUAeABlAGMAdQB0AGUATgBlAHQASQBuAHMAdABhAGwAbABlAHIAcwAgACIAJABlAG4AdgA6AEkAbgBuAG8AcwBlAHQAdQBwAFQAbQBwAFAAYQB0AGgAXAAuAE4ARQBUACIACgAgACAAZQB4AGUAYwB1AHQAZQBOAGUAdABJAG4AcwB0AGEAbABsAGUAcgBzACAAIgBDADoAXABJAG4AcwB0AGEAbABsAFwAUwBjAGgAbQBpAGQAXABTAEMASABNAEkARAB3AGEAdABjAGgASQBuAHMAdABhAGwAbABlAHIAXABTAFcALQBCAGEAcwBlAEkAbgBzAHQAYQBsAGwALQBwAGEAYwBrAGEAZwBlAFwAQQBkAGQAaQB0AGkAbwBuAGEAbAAuAE4ARQBUACIACgB9ACAAYwBhAHQAYwBoAAoAewAKACAAIAAkAF8ACgAgACAAZQB4AGkAdAAgADgAOAA4AAoAfQAKACMAIwAjACMAIwAjACMA"',0,0,0);


end;
